<html>
    <head>
        <meta charset="utf-8"/>

        <!-- Third-party-->
        <script src="node_modules/pixi.js/bin/pixi.min.js"></script>
        <script src="node_modules/pathfinding/visual/lib/pathfinding-browser.min.js"></script>


        <!--Debugging -->
        <script src="js/game/Helpers/Enums.js"></script>
        <script src="js/game/Helpers/Geometry.js"></script>
        <script src="js/game/Actors/Sprites/Sprite.js"></script>
        <script src="js/game/Actors/Sprites/SpriteSet.js"></script>
        <script src="js/game/Actors/Sprites/WorldItems/ChestSprites.js"></script>
        <script src="js/game/Actors/Sprites/Characters/PlayerSprites.js"></script>
        <script src="js/game/Actors/Sprites/Characters/ChaserSprites.js"></script>
        <script src="js/game/Actors/Sprites/Environment/FloorSprites.js"></script>
        <script src="js/game/Actors/Sprites/Environment/WallSprites.js"></script>
        <script src="js/game/Actors/Sprites/Environment/Special/OutOfBoundsSprites.js"></script>
        <script src="js/game/Actors/Sprites/Environment/Special/StairsDownSprites.js"></script>
        <script src="js/game/Actors/Behaviour/Command.js"></script>
        <script src="js/game/Actors/Behaviour/Action.js"></script>
        <script src="js/game/Actors/Behaviour/Commands/MoveTo.js"></script>
        <script src="js/game/Actors/Behaviour/Actions/Move.js"></script>
        <script src="js/game/Actors/Base/Actor.js"></script>
        <script src="js/game/Actors/Inventory/Base/InventoryItem.js"></script>
        <script src="js/game/Actors/Inventory/Potion.js"></script>
        <script src="js/game/Actors/WorldItems/Base/WorldItem.js"></script>
        <script src="js/game/Actors/WorldItems/Chest.js"></script>
        <script src="js/game/Renderers/Renderer.js"></script>
        <script src="js/game/Actors/Environment/Wall.js"></script>
        <script src="js/game/Actors/Environment/Floor.js"></script>
        <script src="js/game/Actors/Environment/Special/StairsDown.js"></script>
        <script src="js/game/Actors/Environment/Special/OutOfBounds.js"></script>
        <script src="js/game/Actors/Character/Player.js"></script>
        <script src="js/game/Actors/Character/Chaser.js"></script>
        <script src="js/game/Layer.js"></script>
        <script src="js/game/World.js"></script>
        <script src="js/game/Room.js"></script>
        <script src="js/game/Point.js"></script>
        <script src="js/game/Helpers/Rendering.js"></script>
        <script src="js/game/Helpers/Extensions.js"></script>
        <script src="js/game/Helpers/Random.js"></script>
        <script src="js/game/Helpers/Numbers.js"></script>
        <script src="js/game/Helpers/Movement.js"></script>
        <script src="js/game/Helpers/Generation/GenerationHelpers.js"></script>
        <script src="js/game/Renderers/TextRenderer.js"></script>
        <script src="js/game/Renderers/PixiRenderer.js"></script>
        <script src="js/game/Helpers/Generation/WorldGenerator.js"></script>
        <script src="js/game/Menu/Menu.js"></script>
        <script src="js/game/Menu/Menus/MainMenu.js"></script>
        <script src="js/game/Game.js"></script>

        <!-- Built -->
        <!--<script src="js/game.min.js"></script>-->

        <script type="text/javascript">
            // on DOM load
            document.addEventListener("DOMContentLoaded", function(event) {
                // Load resources
                PIXI.loader
                           .add('terrainAtlas','art/rogueliketiles.json')
                           .add('characterAtlas','art/characters_1.json')
                           .load(setupGame);

                // On resources load
                function setupGame(){
                    // Setup resources

                    // Setup game
                    var seed = (new Date).getTime(); // or specify a seed to be used by the entire game

                    // Our area to render to
                    var canvas = document.getElementById('canvas');

                    // The renderer to use (implements the same functions). Renders to the canvas
                    // var renderer = new TextRenderer(
                    //   canvas,
                    //   30, // view width
                    //   20  // view height
                    // );
                    var renderer = new PixiRenderer(
                      canvas,
                      30, // view width
                      20  // view height
                    );

                    // Start the game
                    var game = new Game(renderer, seed);
                    game.setRandomDungeon();
                    game.start();

                    // Bind keys
                    document.onkeydown = checkKey;

                    function checkKey(e) {
                          e = e || window.event;

                          // Arrow Keys
                          if (e.keyCode == '38') {
                              game.controlPressed(Controls.UpArrow);
                          }
                          else if (e.keyCode == '40') {
                              game.controlPressed(Controls.DownArrow);
                          }
                          else if (e.keyCode == '37') {
                              game.controlPressed(Controls.LeftArrow);
                          }
                          else if (e.keyCode == '39') {
                              game.controlPressed(Controls.RightArrow);
                          }

                          else if(e.keyCode == '80'){ // letter 'p'
                              game.controlPressed(Controls.Attack);
                          }

                          else if(e.keyCode == '32'){
                  					  game.controlPressed(Controls.Space);
                  				}

                          else if(e.keyCode == '13'){
                  					  game.controlPressed(Controls.Enter);
                  				}

                          else if(e.keyCode == '8'){
                  					  game.controlPressed(Controls.Backspace);
                  				}

                          else if(e.keyCode == '27'){
                  					  game.controlPressed(Controls.Escape);
                  				}
                      }
                }
            });
        </script>
    </head>
    <body style="background-color:black;">
        <div id="canvas" style="height:100%;width:100%">

        </div>
    </body>
</html>
